F3_start<-frame_counts_start[,3]
frame_counts_end<-read.delim('frame_counts_TERM.txt',row.names=1, header = T)    #F1,F2,F3: col,1,2,3
F1_term<-frame_counts_end[,1]
F2_term<-frame_counts_end[,2]
F3_term<-frame_counts_end[,3]
mat<-cbind(mat,F1_start,F2_start,F3_start,F1_term,F2_term,F3_term)
fourier <-read.delim('transcript_fft.txt',row.names=1, header = T)               #period, signal: col2,3
fft_period<-fourier[,2]
fft_signal<-fourier[,3]
mat<-cbind(mat,fft_period,fft_signal)
write.table(mat, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/mat_by4741-happycell_odlow-r1_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
setwd('/Users/irene.stevens/Documents/Data/yeast_fivepseq/fivepseq_out/fivepseq_counts/by4741-happycell_odlow-r2_s1/protein_coding/')
options(stringsAsFactors = FALSE)
tx<-read.delim('transcript_assembly.txt',row.names=1, header = T)
tx<-tx[,1:4]
tx.descr<-read.delim('transcript_descriptors.txt',row.names=1, header = T)       #len, numMappedPositions: col 3,7
len<-tx.descr[,3]
numMappedPos<-tx.descr[,7]
mat<-cbind(tx,len,numMappedPos)
mat<-mat[,5:6]
frame_pref<-read.delim('transcript_frame_prefs.txt', row.names=1, header = T)    #fpi,F,f_perc: col2,4,5
FPI<-frame_pref[,5]
Frame<-frame_pref[,2]
f_perc<-frame_pref[,4]
count<-frame_pref[,1]
mat<-cbind(mat,FPI,Frame,f_perc,count)
frame_counts_start<-read.delim('frame_counts_START.txt',row.names=1, header = T) #F1,F2,F3: col,1,2,3
F1_start<-frame_counts_start[,1]
F2_start<-frame_counts_start[,2]
F3_start<-frame_counts_start[,3]
frame_counts_end<-read.delim('frame_counts_TERM.txt',row.names=1, header = T)    #F1,F2,F3: col,1,2,3
F1_term<-frame_counts_end[,1]
F2_term<-frame_counts_end[,2]
F3_term<-frame_counts_end[,3]
mat<-cbind(mat,F1_start,F2_start,F3_start,F1_term,F2_term,F3_term)
fourier <-read.delim('transcript_fft.txt',row.names=1, header = T)               #period, signal: col2,3
fft_period<-fourier[,2]
fft_signal<-fourier[,3]
mat<-cbind(mat,fft_period,fft_signal)
write.table(mat, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/mat_by4741-happycell_odlow-r2_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
setwd('/Users/irene.stevens/Documents/Data/yeast_fivepseq/fivepseq_out/fivepseq_counts/by4741-ypd_ctr-r1_s1/protein_coding/')
options(stringsAsFactors = FALSE)
tx<-read.delim('transcript_assembly.txt',row.names=1, header = T)
tx<-tx[,1:4]
tx.descr<-read.delim('transcript_descriptors.txt',row.names=1, header = T)       #len, numMappedPositions: col 3,7
len<-tx.descr[,3]
numMappedPos<-tx.descr[,7]
mat<-cbind(tx,len,numMappedPos)
mat<-mat[,5:6]
frame_pref<-read.delim('transcript_frame_prefs.txt', row.names=1, header = T)    #fpi,F,f_perc: col2,4,5
FPI<-frame_pref[,5]
Frame<-frame_pref[,2]
f_perc<-frame_pref[,4]
count<-frame_pref[,1]
mat<-cbind(mat,FPI,Frame,f_perc,count)
frame_counts_start<-read.delim('frame_counts_START.txt',row.names=1, header = T) #F1,F2,F3: col,1,2,3
F1_start<-frame_counts_start[,1]
F2_start<-frame_counts_start[,2]
F3_start<-frame_counts_start[,3]
frame_counts_end<-read.delim('frame_counts_TERM.txt',row.names=1, header = T)    #F1,F2,F3: col,1,2,3
F1_term<-frame_counts_end[,1]
F2_term<-frame_counts_end[,2]
F3_term<-frame_counts_end[,3]
mat<-cbind(mat,F1_start,F2_start,F3_start,F1_term,F2_term,F3_term)
fourier <-read.delim('transcript_fft.txt',row.names=1, header = T)               #period, signal: col2,3
fft_period<-fourier[,2]
fft_signal<-fourier[,3]
mat<-cbind(mat,fft_period,fft_signal)
write.table(mat, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/mat_by4741-ypd_ctr-r1_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
setwd('/Users/irene.stevens/Documents/Data/yeast_fivepseq/fivepseq_out/fivepseq_counts/by4741-ypd_ctr-r2_s1/protein_coding/')
options(stringsAsFactors = FALSE)
tx<-read.delim('transcript_assembly.txt',row.names=1, header = T)
tx<-tx[,1:4]
tx.descr<-read.delim('transcript_descriptors.txt',row.names=1, header = T)       #len, numMappedPositions: col 3,7
len<-tx.descr[,3]
numMappedPos<-tx.descr[,7]
mat<-cbind(tx,len,numMappedPos)
mat<-mat[,5:6]
frame_pref<-read.delim('transcript_frame_prefs.txt', row.names=1, header = T)    #fpi,F,f_perc: col2,4,5
FPI<-frame_pref[,5]
Frame<-frame_pref[,2]
f_perc<-frame_pref[,4]
count<-frame_pref[,1]
mat<-cbind(mat,FPI,Frame,f_perc,count)
frame_counts_start<-read.delim('frame_counts_START.txt',row.names=1, header = T) #F1,F2,F3: col,1,2,3
F1_start<-frame_counts_start[,1]
F2_start<-frame_counts_start[,2]
F3_start<-frame_counts_start[,3]
frame_counts_end<-read.delim('frame_counts_TERM.txt',row.names=1, header = T)    #F1,F2,F3: col,1,2,3
F1_term<-frame_counts_end[,1]
F2_term<-frame_counts_end[,2]
F3_term<-frame_counts_end[,3]
mat<-cbind(mat,F1_start,F2_start,F3_start,F1_term,F2_term,F3_term)
fourier <-read.delim('transcript_fft.txt',row.names=1, header = T)               #period, signal: col2,3
fft_period<-fourier[,2]
fft_signal<-fourier[,3]
mat<-cbind(mat,fft_period,fft_signal)
write.table(mat, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/mat_by4741-ypd_ctr-r2_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
setwd('/Users/irene.stevens/Documents/Data/yeast_fivepseq/fivepseq_out/fivepseq_counts/by4741-ypd_ctr-r3_s1/protein_coding/')
options(stringsAsFactors = FALSE)
tx<-read.delim('transcript_assembly.txt',row.names=1, header = T)
tx<-tx[,1:4]
tx.descr<-read.delim('transcript_descriptors.txt',row.names=1, header = T)       #len, numMappedPositions: col 3,7
len<-tx.descr[,3]
numMappedPos<-tx.descr[,7]
mat<-cbind(tx,len,numMappedPos)
mat<-mat[,5:6]
frame_pref<-read.delim('transcript_frame_prefs.txt', row.names=1, header = T)    #fpi,F,f_perc: col2,4,5
FPI<-frame_pref[,5]
Frame<-frame_pref[,2]
f_perc<-frame_pref[,4]
count<-frame_pref[,1]
mat<-cbind(mat,FPI,Frame,f_perc,count)
frame_counts_start<-read.delim('frame_counts_START.txt',row.names=1, header = T) #F1,F2,F3: col,1,2,3
F1_start<-frame_counts_start[,1]
F2_start<-frame_counts_start[,2]
F3_start<-frame_counts_start[,3]
frame_counts_end<-read.delim('frame_counts_TERM.txt',row.names=1, header = T)    #F1,F2,F3: col,1,2,3
F1_term<-frame_counts_end[,1]
F2_term<-frame_counts_end[,2]
F3_term<-frame_counts_end[,3]
mat<-cbind(mat,F1_start,F2_start,F3_start,F1_term,F2_term,F3_term)
fourier <-read.delim('transcript_fft.txt',row.names=1, header = T)               #period, signal: col2,3
fft_period<-fourier[,2]
fft_signal<-fourier[,3]
mat<-cbind(mat,fft_period,fft_signal)
write.table(mat, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/mat_by4741-ypd_ctr-r3_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
setwd('/Users/irene.stevens/Documents/Data/yeast_fivepseq/fivepseq_out/fivepseq_counts/by4741-ypd_ctr-r4_s1/protein_coding/')
options(stringsAsFactors = FALSE)
tx<-read.delim('transcript_assembly.txt',row.names=1, header = T)
tx<-tx[,1:4]
tx.descr<-read.delim('transcript_descriptors.txt',row.names=1, header = T)       #len, numMappedPositions: col 3,7
len<-tx.descr[,3]
numMappedPos<-tx.descr[,7]
mat<-cbind(tx,len,numMappedPos)
mat<-mat[,5:6]
frame_pref<-read.delim('transcript_frame_prefs.txt', row.names=1, header = T)    #fpi,F,f_perc: col2,4,5
FPI<-frame_pref[,5]
Frame<-frame_pref[,2]
f_perc<-frame_pref[,4]
count<-frame_pref[,1]
mat<-cbind(mat,FPI,Frame,f_perc,count)
frame_counts_start<-read.delim('frame_counts_START.txt',row.names=1, header = T) #F1,F2,F3: col,1,2,3
F1_start<-frame_counts_start[,1]
F2_start<-frame_counts_start[,2]
F3_start<-frame_counts_start[,3]
frame_counts_end<-read.delim('frame_counts_TERM.txt',row.names=1, header = T)    #F1,F2,F3: col,1,2,3
F1_term<-frame_counts_end[,1]
F2_term<-frame_counts_end[,2]
F3_term<-frame_counts_end[,3]
mat<-cbind(mat,F1_start,F2_start,F3_start,F1_term,F2_term,F3_term)
fourier <-read.delim('transcript_fft.txt',row.names=1, header = T)               #period, signal: col2,3
fft_period<-fourier[,2]
fft_signal<-fourier[,3]
mat<-cbind(mat,fft_period,fft_signal)
write.table(mat, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/mat_by4741-ypd_ctr-r4_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
setwd('/Users/irene.stevens/Documents/Data/yeast_fivepseq/fivepseq_out/fivepseq_counts/by4741-ypd_ctr-r5_s1/protein_coding/')
options(stringsAsFactors = FALSE)
tx<-read.delim('transcript_assembly.txt',row.names=1, header = T)
tx<-tx[,1:4]
tx.descr<-read.delim('transcript_descriptors.txt',row.names=1, header = T)       #len, numMappedPositions: col 3,7
len<-tx.descr[,3]
numMappedPos<-tx.descr[,7]
mat<-cbind(tx,len,numMappedPos)
mat<-mat[,5:6]
frame_pref<-read.delim('transcript_frame_prefs.txt', row.names=1, header = T)    #fpi,F,f_perc: col2,4,5
FPI<-frame_pref[,5]
Frame<-frame_pref[,2]
f_perc<-frame_pref[,4]
count<-frame_pref[,1]
mat<-cbind(mat,FPI,Frame,f_perc,count)
frame_counts_start<-read.delim('frame_counts_START.txt',row.names=1, header = T) #F1,F2,F3: col,1,2,3
F1_start<-frame_counts_start[,1]
F2_start<-frame_counts_start[,2]
F3_start<-frame_counts_start[,3]
frame_counts_end<-read.delim('frame_counts_TERM.txt',row.names=1, header = T)    #F1,F2,F3: col,1,2,3
F1_term<-frame_counts_end[,1]
F2_term<-frame_counts_end[,2]
F3_term<-frame_counts_end[,3]
mat<-cbind(mat,F1_start,F2_start,F3_start,F1_term,F2_term,F3_term)
fourier <-read.delim('transcript_fft.txt',row.names=1, header = T)               #period, signal: col2,3
fft_period<-fourier[,2]
fft_signal<-fourier[,3]
mat<-cbind(mat,fft_period,fft_signal)
write.table(mat, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/mat_by4741-ypd_ctr-r5_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
setwd('/Users/irene.stevens/Documents/Data/yeast_fivepseq/fivepseq_out/fivepseq_counts/by4741-chx_t05-r1_s1/protein_coding/')
#NMD annotation
nmd<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/tx_nmd_info.txt',row.names=1, header = T)
nmd<-nmd[,4]
#frame matrix
h1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-happycell_odlow-r1_s1.txt",row.names=1, header = T)
h2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-happycell_odlow-r2_s1.txt",row.names=1, header = T)
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-ypd_ctr-r1_s1.txt",row.names=1, header = T)
c2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-ypd_ctr-r2_s1.txt",row.names=1, header = T)
c3<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-ypd_ctr-r3_s1.txt",row.names=1, header = T)
c4<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-ypd_ctr-r4_s1.txt",row.names=1, header = T)
c5<- read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-ypd_ctr-r5_s1.txt",row.names=1, header = T)
#intersect frame with nmd
t1<-cbind(h1,nmd)
t2<-cbind(h2,nmd)
t3<-cbind(c1,nmd)
t4<-cbind(c2,nmd)
t5<-cbind(c3,nmd)
t6<-cbind(c4,nmd)
t7<-cbind(c5,nmd)
#binarize nmd variable
nmd.b<-replace(t1$nmd,t1$nmd>0,1)
h1<-cbind(t1,nmd.b)
write.table(h1, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r1_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
nmd.b2<-replace(t2$nmd,t2$nmd>0,1)
h2<-cbind(t2,nmd.b2)
write.table(h2, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r2_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
nmd.b3<-replace(t3$nmd,t3$nmd>0,1)
c1<-cbind(t3,nmd.b3)
write.table(c1, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
nmd.b4<-replace(t4$nmd,t4$nmd>0,1)
c2<-cbind(t4,nmd.b4)
write.table(c2, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r2_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
nmd.b5<-replace(t5$nmd,t5$nmd>0,1)
c3<-cbind(t5,nmd.b5)
write.table(c3, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r3_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
nmd.b6<-replace(t6$nmd,t6$nmd>0,1)
c4<-cbind(t6,nmd.b6)
write.table(c4, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r4_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
nmd.b7<-replace(t7$nmd,t7$nmd>0,1)
c5<-cbind(t7,nmd.b7)
write.table(c5, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r5_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
training<-read.delim(file.choose(),header=T, row.names=1)
training<-read.delim(file.choose(),header=T, row.names=1)
training<-read.delim(file.choose(),header=T)
train <- subset(train,select=c(1,2,3,4,5,6,7,8,9,10,11,12,13,15)) #remove nmd column
train<-read.delim(file.choose(),header=T)
View(train)    #15 variables
str(train)
sapply(train, function(x) sum(is.na(x)))
sapply(train, function(x) length(unique(x)))
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",row.names=3, header = T)
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",row.names=4, header = T)
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header = T)
View(slip_keys)
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header = T, row.names=5)
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header = T, row.names=1)
sapply(slip_keys, function(x) length(unique(x)))
table(slip_keys$species)
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T, row.names=1)
sapply(slip_keys, function(x) length(unique(x)))
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T, row.names=4)
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T, row.names=1)
sapply(slip_keys, function(x) length(unique(x)))
table(slip_keys$transcript)
table(slip_keys$transcript!==1)
table(slip_keys$transcript!=1)
table(slip_keys$transcript =1)
table(slip_keys$transcript ==1)
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T, row.names=4)
sapply(slip_keys, function(x) length(unique(x)))
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T, row.names=4)
sapply(slip_keys, function(x) length(unique(x)))
slip_keys<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T, row.names=3)
View(slip_keys)
hotknot<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotP_hotknots.txt",header=T, row.names=3)
hotknot<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotP_hotknots.txt",header=T)
sapply(hotknot, function(x) length(unique(x)))
hotknot$knotp
hotknot<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotP_hotknots.txt",header=T, row.names=1)
hotknot<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotP_hotknots.txt",header=T, row.names=1)
hotknot<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotP_hotknots.txt",header=T)
sapply(hotknot, function(x) length(unique(x)))
hotknot1<-hotknot$accession(unique)
hotknot1<-unique(hotknot$accession)
cbind(slip_keys,hotknot1)
cbind(hotknot1,slip_keys)
gene<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T, row.names=1)
slip<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotp.txt",header=T,row.names=1)
slip<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotp.txt",header=T)
cbind(gene,slip)
cbind(gene,slip,check.names=FALSE)
cbind(gene,slip)
merge(gene,slip), by="accession", all = T)
merge(gene,slip, by="accession", all = T)
gene<-as.data.frame(gene)
slip<-as.data.frame(slip)
merge(gene,slip, by="accession", all = T)
sapply(gene, function(x) length(unique(x)))
gene<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/saccharomyces_cerevisiae_gene_info.txt",header=T)
slip<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/knotp.txt",header=T)
merge(gene,slip, by="accession", all = T)
m<-merge(gene,slip, by="accession", all = T)
merge(gene,slip, by="accession", all = T)
dim(m)
View(m)
ctr3<-read.delim(file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r3_s1.txt",row.names=1, header=T)
View(ctr3)
train<-read.delim(file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/training_matrix.txt", header=T)
View(train)
mm<-merge(train,m, by="transcript", all = T)
dim(mm)
View(mm)
mm<-merge(train,m, by="transcript", all = F)
dim(mm)
View(mm)
mm<-merge(train,m, by="transcript", all = T)
write.table(mm, file="/Users/irene.stevens/Desktop/merged_training_matrix", sep="\t", quote=F, row.names=T, col.names=NA)
gene<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_gene_info.txt",header=T)
mfe<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_mfe.txt",header=T)
cbind(gene,mfe)
cbind(gene,mfe)
summary(mfe)
sapply(mfe, function(x) length(unique(x)))
mfe %>% distinct(accession, .keep_all = TRUE)
mfe %>% distinct(accession, .keep_all = TRUE)
dplyr::distinct
dplyr::distinct(mfe$accession)
t<-read.delim("/Users/irene.stevens/Desktop/merged_training_matrix",header=T)
t<-read.delim("/Users/irene.stevens/Desktop/merged_training_matrix.txt",header=T)
dim(t)
View(t)
t<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/mfe_training_matrix.txt",header=T)
sig<-read.delim("/Users/irene.stevens/Desktop/cPRF2_uniq.txt",header=T, row.names=2)
sig<-read.delim("/Users/irene.stevens/Desktop/cPRF2.txt",header=T)
sapply(sig, function(x) length(unique(x)))
library("dplyr")
distinct(data.frame(sig))
sig<-as.data.frame(sig)
distinct(data.frame(sig))
sig[!duplicated(sig$Gene), ]
sig[!duplicated(sig$Gene), ]
m<-sig[!duplicated(sig$Gene), ]
dim(m)
View(m)
write.table(m, file="/Users/irene.stevens/Desktop/uniq_cPRF2.txt", sep="\t", quote=F, row.names=T, col.names=NA)
train<-read.delim(file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/training_matrix.txt", header=T)
cbind(train,m)
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt",header=T,row.names =1)
View(c1)
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt",header=T,row.names =1)
sig<-read.delim("/Users/irene.stevens/Desktop/uniq_cPRF2.txt",header=T,row.names=2)
cbind(c1,sig)
transcript
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt",header=T,row.names =1)
sig<-read.delim("/Users/irene.stevens/Desktop/uniq_cPRF2.txt",header=T,row.names=2)
sig<-read.delim("/Users/irene.stevens/Desktop/uniq_cPRF2.txt",header=T,row.names=1)
t1<-merge(c1,sig, by="transcript", all = F)
View(c1)
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt",header=T)
sig<-read.delim("/Users/irene.stevens/Desktop/uniq_cPRF2.txt",header=T)
t1<-merge(c1,sig, by="transcript", all = F)
View(t1)
gene<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_gene_info.txt,header=T,row.names=1)
gene<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_gene_info.txt",header=T,row.names=1)
boot<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_boot.txt",header=T,row.names=2)
boot<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_boot.txt",header=T,row.names=1)
mfe<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_mfe.txt",header=T,row.names=1)
mb<-cbind(boot,mfe)
help("cbind")
dim(gene)
dim(boot)
dim(mfe)
head(gene)
sgid<-gene$accession
tx<-gene$genename
head(boot)
dim(gene)
dim(boot)
dim(mfe)
mfe<-boot$mfe_mean
zscore<-boot$zscore
head(m
)
boot<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_boot.txt",header=T,row.names=1)
> mfe<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_mfe.txt",header=T,row.names=1)
gene<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_gene_info.txt",header=T,row.names=1)
boot<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_boot.txt",header=T,row.names=1)
mfe<-read.delim("/Users/irene.stevens/Desktop/saccharomyces_cerevisiae_mfe.txt",header=T,row.names=1)
head(mfe)
table(mfe$mfe<17.3)
sgid<-gene$accession
tx<-gene$genename
m<-boot$mfe_mean
knotp<-mfe$knotp
m<-cbind(tx,sgid,m,knotp)
t<-merge(gene,boot,by='accession',keep.all=T)
View(t)
dim(t)
t<-merge(gene,boot,by='accession',keep.all=F)
dim(t)
t<-merge(boot,gene,by='accession',keep.all=T)
dim(t)
t<-merge(boot,gene,keep.all=T)
dim(t)
t<-merge(boot,gene,by='accession',keep.all=T)
write.table(t, file="/Users/irene.stevens/Desktop/boot_gene.txt", sep="\t", quote=F, row.names=T, col.names=NA)
ref<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/Organism_Genes.txt',header=T, row.names=1)
mylist<-cbind(ref,t)
mylist<-merge(ref,t,by='accession',keep.all=T)
ref<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/Organism_Genes.txt',header=T)
mylist<-merge(ref,t,by='accession',keep.all=T)
dim(mylist)
dim(ref)
mylist<-merge(t,ref,by='accession',keep.all=T)
dim(ref)
dim(mylist)
dim(t)
mylist<-merge(t,ref)
dim(mylist)
View(mylist)
View(ref)
mylist<-merge(ref,t,by='accession',keep.all=T)
t<-read.delim('/Users/irene.stevens/Desktop/boot_gene.txt',header=T)
mylist<-merge(ref,t,by='accession',keep.all=T)
dim(mylist)
View(mylist)
mylist<-merge(ref,t)
dim(mylist)
View(t)
ref<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/Organism_Genes.txt',header=T)
mylist<-merge(ref,t,by='genename',keep.all=T)
dim(mylist)
View(mylist)
write.table(mylist, file="/Users/irene.stevens/Desktop/boot_gene.txt", sep="\t", quote=F, row.names=T, col.names=NA)
tx<-read.delim('/Users/irene.stevens/Desktop/tx_ribosomal_frameshifts.txt',header=T)
tx<-read.delim('/Users/irene.stevens/Desktop/tx_ribosomal_frameshifts.txt')
table(tx$X0)
rfs<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/tx_ribosomal_frameshifts.txt',row.names=1, header = T)
rfs<-rfs[,4]
#frame matrix
h1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/frame_mats/mat_by4741-happycell_odlow-r1_s1.txt",row.names=1, header = T)
#frame matrix
h1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r1_s1.txt",row.names=1, header = T)
h2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r2_s1.txt",row.names=1, header = T)
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt",row.names=1, header = T)
c2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r2_s1.txt",row.names=1, header = T)
c3<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r3_s1.txt",row.names=1, header = T)
c4<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r4_s1.txt",row.names=1, header = T)
c5<- read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r5_s1.txt",row.names=1, header = T)
#intersect nmd_mat with ribosome frameshifting signal
t1<-cbind(h1,rfs)
t2<-cbind(h2,rfs)
t3<-cbind(c1,rfs)
t4<-cbind(c2,rfs)
t5<-cbind(c3,rfs)
t6<-cbind(c4,rfs)
t7<-cbind(c5,rfs)
View(t7)
plot(t7$nmd.b7,t7$rfs)
cor(t7$nmd.b7,t7$rfs)
cor.test(t7$nmd.b7,t7$rfs)
cor.test(t7$nmd,t7$rfs)
#ribosome frameshift signal
rfs<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/tx_ribosomal_frameshifts.txt',row.names=1, header = T)
rfs<-rfs[,4]
summary(rfs)
#frame matrix
h1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r1_s1.txt",row.names=1, header = T)
h2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r2_s1.txt",row.names=1, header = T)
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt",row.names=1, header = T)
c2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r2_s1.txt",row.names=1, header = T)
c3<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r3_s1.txt",row.names=1, header = T)
c4<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r4_s1.txt",row.names=1, header = T)
c5<- read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r5_s1.txt",row.names=1, header = T)
#intersect nmd_mat with ribosome frameshifting signal
t1<-cbind(h1,rfs)
t2<-cbind(h2,rfs)
t3<-cbind(c1,rfs)
t4<-cbind(c2,rfs)
t5<-cbind(c3,rfs)
t6<-cbind(c4,rfs)
t7<-cbind(c5,rfs)
#write final table
write.table(t1, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-sc-r1_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t2, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-sc-r2_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t3, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-sc-r3_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t4, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-sc-r4_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t5, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-sc-r5_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t6, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-sc-r6_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t7, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_nmd_by4741-sc-r7_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
#ribosome frameshift signal
rfs<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/tx_ribosomal_frameshifts.txt',row.names=1, header = T)
rfs<-rfs[,4]
#frame matrix
h1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r1_s1.txt",row.names=1, header = T)
h2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-happycell_odlow-r2_s1.txt",row.names=1, header = T)
c1<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r1_s1.txt",row.names=1, header = T)
c2<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r2_s1.txt",row.names=1, header = T)
c3<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r3_s1.txt",row.names=1, header = T)
c4<-read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r4_s1.txt",row.names=1, header = T)
c5<- read.delim("/Users/irene.stevens/Documents/Data/yeast_fivepseq/nmd_by4741-ypd_ctr-r5_s1.txt",row.names=1, header = T)
#intersect nmd_mat with ribosome frameshifting signal
t1<-cbind(h1,rfs)
t2<-cbind(h2,rfs)
t3<-cbind(c1,rfs)
t4<-cbind(c2,rfs)
t5<-cbind(c3,rfs)
t6<-cbind(c4,rfs)
t7<-cbind(c5,rfs)
#write final table
write.table(t1, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-happycell_odlow-r1_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t2, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-happycell_odlow-r2_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t3, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-ypd_ctr-r1_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t4, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-ypd_ctr-r2_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t5, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-ypd_ctr-r3_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t6, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-ypd_ctr-r4_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
write.table(t7, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/rfs_nmd_by4741-ypd_ctr-r5_s1.txt", sep="\t", quote=F, row.names=T, col.names=NA)
mat<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/training_matrix_noNA.txt',header=T,row.names=1)
mat<-read.delim('/Users/irene.stevens/Documents/Data/yeast_fivepseq/training_matrix_noNA.txt',header=T)
rfs2<-replace(mat$rfs,mat$rfs>0,1)
mat2<-cbind(mat,rfs2)
View(mat2)
table(mat2$rfs2)
write.table(mat2, file="/Users/irene.stevens/Documents/Data/yeast_fivepseq/training_matrix_b.txt", sep="\t", quote=F, row.names=T, col.names=NA)
t<-merge(boot,gene,by='accession',keep.all=T)
write.table(t, file="/Users/irene.stevens/Desktop/boot_gene.txt", sep="\t", quote=F, row.names=T, col.names=NA)
